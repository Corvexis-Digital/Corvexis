import{j as e,L as p,p as x,l as f,a as g,s as j}from"./index-DcyBRlfo.js";import{r as n}from"./vendor-lottie-BKil9D5R.js";import{U as y,T as w}from"./Toast-DpFMzWfU.js";function b(){const[a,u]=n.useState(null),[r,c]=n.useState([]),[d,m]=n.useState(""),[l,i]=n.useState({show:!1,message:"",type:"info"});n.useEffect(()=>{(async()=>{if(a)try{if(m(""),/spreadsheetml|ms-excel/.test(a.type)){const s=await x(a);c(s),i({show:!0,message:`Parsed ${s.length} assignments`,type:"success"})}else{const s=await f(a);c(s),i({show:!0,message:`Scanned ${s.length} assignments`,type:"success"})}}catch(s){m(s.message),i({show:!0,message:s.message,type:"error"})}})()},[a]);async function h(){var s;const t=(s=g.currentUser)==null?void 0:s.uid;if(t){for(const o of r)await j("assignments",{userId:t,moduleCode:o.moduleCode,title:o.title,dueDate:o.dueDate,description:o.description});alert("Saved")}}return e.jsxs(p,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{onFile:u}),e.jsx("div",{children:e.jsx("button",{className:"px-4 py-2 rounded-full bg-black text-white",onClick:h,disabled:!r.length,children:"Save All"})}),d&&e.jsx("div",{className:"text-red-600 text-sm",children:d}),!!r.length&&e.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Draft Assignments"}),e.jsx("div",{className:"space-y-3",children:r.map((t,s)=>e.jsxs("div",{className:"border rounded-3xl p-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:t.moduleCode}),e.jsx("div",{className:"font-medium",children:t.title}),e.jsxs("div",{className:"text-sm",children:["Due: ",t.dueDate]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]},s))})]})]}),e.jsx(w,{show:l.show,message:l.message,type:l.type,onClose:()=>i(t=>({...t,show:!1}))})]})}export{b as default};
