import{j as s,L as h,n as p,a as f,s as j}from"./index-DcyBRlfo.js";import{r as a}from"./vendor-lottie-BKil9D5R.js";import{U as g,T as y}from"./Toast-DpFMzWfU.js";function b(){const[d,m]=a.useState(null),[r,u]=a.useState([]),[c,n]=a.useState(""),[l,i]=a.useState({show:!1,message:"",type:"info"});a.useEffect(()=>{(async()=>{if(d)try{n("");const t=await p(d);u(t),i({show:!0,message:`Detected ${t.length} modules`,type:"success"})}catch(t){n(t.message),i({show:!0,message:t.message,type:"error"})}})()},[d]);async function x(){var t;const e=(t=f.currentUser)==null?void 0:t.uid;if(e){for(const o of r)await j("modules",{userId:e,code:o.code,title:o.title,credits:Number(o.credits)||0,description:o.summary||""});alert("Modules saved")}}return s.jsxs(h,{children:[s.jsxs("div",{className:"space-y-6",children:[s.jsx(g,{onFile:m}),s.jsx("div",{children:s.jsx("button",{className:"px-4 py-2 rounded-full bg-black text-white",onClick:x,disabled:!r.length,children:"Save All"})}),c&&s.jsx("div",{className:"text-red-600 text-sm",children:c}),!!r.length&&s.jsxs("div",{className:"rounded-3xl bg-white p-6 shadow-sm",children:[s.jsx("h3",{className:"font-semibold mb-3",children:"Detected Modules"}),s.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:r.map((e,t)=>s.jsxs("div",{className:"rounded-3xl border p-5 hover:shadow",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"font-semibold",children:e.code}),s.jsxs("span",{className:"text-xs text-gray-500",children:["Credits ",e.credits]})]}),s.jsx("div",{className:"mt-1",children:e.title}),e.summary&&s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:e.summary})]},t))})]})]}),s.jsx(y,{show:l.show,message:l.message,type:l.type,onClose:()=>i(e=>({...e,show:!1}))})]})}export{b as default};
